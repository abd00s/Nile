<p id="notice"><%= notice %></p>

<p>
	<strong>Name:</strong>
	<%= @product.name %>
</p>

<p>
	<strong>Description:</strong>
	<%= @product.description %>
</p>

<p>
	<strong>Price in cents:</strong>
	<%= @product.formatted_price %>
</p>
<% if current_user %>
<% #@search = Review.search(params[:q]) %>
<% #@search_result = @search.result %>

<h3>Reviews</h3>

<p>Reviews for <%= @product.name %></p>
<table>
<tr>
 <b> Sort by: </b>
 <ul>
 	<li>
 		<%= @dir_arrow if @sort_by == "created_at" %>
 		<%= link_to "Date", "?sort_by=created_at&direction=#{@opposite_dir}" %>
	</li>
 	<li>
 		<%= @dir_arrow if @sort_by == "comment" %>
 		<%= link_to "Comment", "?sort_by=comment&direction=#{@opposite_dir}" %>
	</li>
</ul>

  </tr>


<% @reviews.each do |review| %>

	<thead> <tr> <td><%= review.comment %></td> </tr> </thead> 
	<% if review.user != nil %>
	<tbody> <tr> <td><em> by <%= review.user.name %></em></td> </tr> </tbody>
	<tbody> <tr> <td>Added on: <%= review.created_at %></td> </tr> </tbody>
	<% end %>

<% end %>
</table>
<h4>New Review</h4>

<%= form_for([@product, @review]) do |f| %>
<% if @review.errors.any? %>
<div id="error_explanation">
	<h2><%= pluralize(@review.errors.count, "error") %> prohibited this review from being saved:</h2>

	<ul>
		<% @review.errors.full_messages.each do |msg| %>
		<li><%= msg %></li>
		<% end %>
	</ul>
</div>
<% end %>

<div class="field">
	<%= f.label :comment %><br />
	<%= f.text_area :comment %>
</div>
<div class="actions">
	<%= f.submit %>
</div>
<% end %>

<% else %>
<p>Please <%= link_to "log in", new_session_path %> to add a review.</p>

<% end %>
<%= link_to 'Edit', edit_product_path(@product) %> |
<%= link_to 'Delete', product_path(@product), method: :delete %> |
<%= link_to 'Back', products_path %>
